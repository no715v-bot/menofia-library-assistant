/* --- CSS STYLES --- */

:root {
    /* Color Palette: Menofia University Theme (Blue & Gold) */
    --bg-color: #f8f9fa;      /* Clean academic white/grey */
    --chat-bg: #ffffff;       /* White chat bubble container */
    
    /* Menofia University Primary Blue */
    --primary-color: #004e82; 
    --primary-hover: #003a61;
    
    --text-main: #2d3748;
    --text-light: #718096;
    --user-bubble: #e2e8f0;
    
    /* Very light blue tint for bot background */
    --bot-bubble: #f0f7fb;    
    
    --border-color: #e2e8f0;
    
    /* Menofia Gold/Yellow (from the logo's wheat ears) */
    --accent-wood: #bf9000;   
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg-color);
    background-image: radial-gradient(var(--text-light) 1px, transparent 1px);
    background-size: 24px 24px;
    background-attachment: fixed;
    color: var(--text-main);
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
}

/* RTL Handling for Arabic */
body.rtl {
    direction: rtl;
    font-family: 'Cairo', sans-serif;
    text-align: right;
}

/* --- Background Doodles --- */
.doodle-bg {
    position: absolute;
    z-index: -1;
    opacity: 0.04;
    pointer-events: none;
    user-select: none;
    font-family: 'Lora', serif;
}
/* Doodles remain absolute, positions might need minor mirroring logic if strict RTL required, but scattered looks fine */
.doodle-1 { font-size: 15rem; bottom: -50px; left: -50px; transform: rotate(15deg); color: var(--primary-color); }
.doodle-2 { font-size: 10rem; top: 10%; right: -20px; transform: rotate(-10deg); color: var(--accent-wood); }
.doodle-3 { font-size: 8rem; bottom: 20%; right: 10%; transform: rotate(25deg); color: var(--text-main); }
.doodle-4 { font-size: 6rem; top: 15%; left: 5%; transform: rotate(-20deg); color: var(--primary-color); }
.doodle-5 { font-size: 12rem; top: 40%; left: -40px; transform: rotate(5deg); color: var(--accent-wood); }
.doodle-6 { font-size: 7rem; bottom: 5%; left: 40%; transform: rotate(-15deg); color: var(--text-light); }
.doodle-7 { font-size: 9rem; top: -30px; left: 40%; transform: rotate(180deg); color: var(--primary-color); opacity: 0.03; }
.doodle-8 { font-size: 5rem; top: 50%; right: 5%; transform: rotate(30deg); color: var(--accent-wood); }

/* --- Intro Screen --- */
#intro-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: white;
    z-index: 2000;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 2rem;
    transition: opacity 0.8s ease-in-out, visibility 0.8s, transform 0.8s cubic-bezier(0.22, 1, 0.36, 1), filter 0.8s ease;
}

#intro-screen.hidden {
    opacity: 0;
    visibility: hidden;
    transform: scale(1.15);
    filter: blur(10px);
    pointer-events: none;
}

.intro-content {
    max-width: 600px;
    width: 100%;
    animation: fadeIn 0.8s ease-out;
    padding-top: 60px; 
    display: flex;
    flex-direction: column;
    align-items: center; /* Center children horizontally */
}

.intro-logo {
    position: absolute;
    top: 30px;
    right: 30px;
    max-width: 180px;
    height: auto;
    z-index: 2010;
}

/* Mirror logo position in RTL */
body.rtl .intro-logo {
    right: auto;
    left: 30px;
}

/* Language Button on Intro - UPDATED POSITION & ANIMATION */
.intro-lang-btn {
    /* Removed absolute positioning */
    position: relative;
    margin-top: 20px;
    background-color: transparent;
    border: 1px solid var(--primary-color);
    padding: 8px 24px;
    border-radius: 20px;
    cursor: pointer;
    font-weight: 600;
    color: var(--primary-color);
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    font-family: 'Cairo', sans-serif; /* Always use Cairo for lang switch */
    opacity: 0; /* Hidden initially for animation */
    animation: slideUpFade 0.6s ease-out 0.8s forwards; /* Delay to play after intro fadeIn */
}

@keyframes slideUpFade {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.intro-lang-btn:hover {
    background-color: var(--primary-color);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(0, 78, 130, 0.2);
}

.intro-title {
    font-family: 'Lora', serif;
    font-size: 2.5rem;
    color: var(--primary-color);
    margin-bottom: 0.5rem;
    font-weight: 700;
}

body.rtl .intro-title { font-family: 'Cairo', sans-serif; }

.intro-subtitle {
    font-size: 1.25rem;
    color: var(--text-light);
    margin-bottom: 3rem;
    font-weight: 500;
}

.credits-box {
    background-color: var(--bot-bubble);
    padding: 2rem;
    border-radius: 12px;
    border: 1px solid var(--border-color);
    margin-bottom: 3rem;
    width: 100%; /* Ensure full width relative to parent */
}

.supervision-label {
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    color: var(--text-light);
    margin-bottom: 0.5rem;
    font-weight: 600;
}

.supervisor-name {
    font-family: 'Lora', serif;
    font-size: 1.5rem;
    color: var(--primary-color);
    font-weight: 700;
    margin-bottom: 1.5rem;
}
body.rtl .supervisor-name { font-family: 'Cairo', sans-serif; }

.other-credits {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    font-size: 0.95rem;
    color: var(--text-main);
    border-top: 1px solid rgba(0,0,0,0.1);
    padding-top: 1rem;
}

.start-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    padding: 18px 54px;
    font-size: 1.1rem;
    font-weight: 600;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    box-shadow: 0 4px 6px rgba(0, 78, 130, 0.2);
    font-family: 'Inter', sans-serif;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}
body.rtl .start-btn { font-family: 'Cairo', sans-serif; }

.start-btn:hover {
    background-color: var(--primary-hover);
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 8px 15px rgba(0, 78, 130, 0.3);
}

/* --- App Interface --- */
#app-interface {
    display: flex;
    flex-direction: column;
    height: 100vh;
    width: 100%;
    opacity: 0; 
    transform: scale(0.95) translateY(20px);
    transition: opacity 0.8s ease-out, transform 0.8s cubic-bezier(0.19, 1, 0.22, 1);
}

#app-interface.visible {
    opacity: 1;
    transform: scale(1) translateY(0);
}

header {
    background-color: var(--primary-color);
    padding: 1rem 1.5rem;
    border-bottom: 1px solid var(--primary-hover);
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    flex-shrink: 0;
    color: white;
}

.logo-area {
    display: flex;
    align-items: center;
    gap: 10px;
}

h1 {
    font-family: 'Lora', serif;
    font-size: 1.25rem;
    font-weight: 600;
    color: white;
}
body.rtl h1 { font-family: 'Cairo', sans-serif; }

.header-controls {
    display: flex;
    gap: 8px;
    align-items: center;
}

.icon-btn {
    background: none;
    border: none;
    font-size: 1.4rem;
    cursor: pointer;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    transition: background-color 0.2s, transform 0.2s;
    color: rgba(255, 255, 255, 0.9);
    display: flex;
    align-items: center;
    justify-content: center;
}
.icon-btn:hover { background-color: rgba(255, 255, 255, 0.15); }

/* Small lang button in header */
.header-lang-btn {
    font-family: 'Cairo', sans-serif;
    font-size: 0.9rem;
    color: white;
    background: rgba(255,255,255,0.2);
    border: none;
    padding: 4px 10px;
    border-radius: 12px;
    cursor: pointer;
    margin-right: 8px; /* margin-left in RTL handled by browser usually? no, direction swap handles it */
}
.header-lang-btn:hover { background: rgba(255,255,255,0.3); }

/* --- Chat Area --- */
#chat-container {
    flex: 1;
    padding: 2rem;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    scroll-behavior: smooth;
    max-width: 900px;
    margin: 0 auto;
    width: 100%;
}

.message {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    max-width: 85%;
    animation: fadeIn 0.3s ease-up;
}

.message.user {
    margin-left: auto; /* In RTL this becomes margin-right logic visually if flex-direction isn't forced, let's explicit */
    flex-direction: row-reverse;
}
/* In RTL mode, 'margin-left: auto' pushes it to the LEFT (which is "start" in RTL), we want it on the "end" (Left side visually in LTR, Right side visually in RTL? No user is always 'me')
   Actually: 
   LTR: User on Right (margin-left: auto).
   RTL: User on Left (margin-right: auto).
   The `direction: rtl` handles swapping `margin-left` to `margin-right` logic mostly, but flexbox `row-reverse` is tricky.
   Let's handle RTL messages specifically to be safe.
*/
body.rtl .message.user {
    margin-right: auto;
    margin-left: 0;
    flex-direction: row-reverse; /* Still reverse to put avatar outside */
}

.avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    flex-shrink: 0;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.bot-avatar { background-color: var(--primary-color); color: white; }
.user-avatar { background-color: var(--accent-wood); color: white; }

.bubble {
    padding: 12px 16px;
    border-radius: 12px;
    font-size: 0.95rem;
    line-height: 1.5;
    position: relative;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    text-align: left;
}
body.rtl .bubble { text-align: right; }

.message.bot .bubble {
    background-color: white;
    border: 1px solid var(--border-color);
    border-top-left-radius: 2px;
}
/* Swap border radius for RTL */
body.rtl .message.bot .bubble {
    border-top-left-radius: 12px;
    border-top-right-radius: 2px;
}

.message.user .bubble {
    background-color: var(--primary-color);
    color: white;
    border-top-right-radius: 2px;
}
body.rtl .message.user .bubble {
    border-top-right-radius: 12px;
    border-top-left-radius: 2px;
}

/* --- Input Area --- */
.input-area {
    background-color: rgba(255, 255, 255, 0.95);
    padding: 1rem 1.5rem 1.5rem 1.5rem;
    border-top: 1px solid var(--border-color);
    flex-shrink: 0;
    backdrop-filter: blur(5px);
}

.quick-actions {
    max-width: 900px;
    margin: 0 auto 12px auto;
    display: flex;
    gap: 10px;
    overflow-x: auto;
    padding-bottom: 4px;
    scrollbar-width: none; 
    -ms-overflow-style: none;
}
.quick-actions::-webkit-scrollbar { display: none; }

.action-btn {
    background-color: white;
    border: 1px solid var(--primary-color);
    color: var(--primary-color);
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 500;
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.2s;
    font-family: 'Inter', sans-serif;
    display: flex;
    align-items: center;
    gap: 6px;
    box-shadow: 0 2px 4px rgba(0, 78, 130, 0.1);
}
body.rtl .action-btn { font-family: 'Cairo', sans-serif; }

.action-btn:hover {
    background-color: var(--bot-bubble);
    transform: translateY(-2px);
}

.input-wrapper {
    max-width: 900px;
    margin: 0 auto;
    position: relative;
    display: flex;
    gap: 10px;
}

#user-input {
    width: 100%;
    padding: 14px 16px;
    padding-right: 50px; 
    border: 1px solid var(--border-color);
    border-radius: 8px;
    font-family: 'Inter', sans-serif;
    font-size: 1rem;
    resize: none; 
    height: 52px; 
    transition: border-color 0.2s;
    box-shadow: 0 2px 6px rgba(0,0,0,0.02);
}
body.rtl #user-input { 
    font-family: 'Cairo', sans-serif; 
    padding-right: 16px;
    padding-left: 50px;
}

#user-input:focus { outline: none; border-color: var(--primary-color); }

#send-btn {
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 0 20px;
    cursor: pointer;
    font-weight: 600;
    transition: background-color 0.2s;
    font-family: inherit;
}
#send-btn:hover { background-color: var(--primary-hover); }

/* Loading Indicator */
.typing-indicator {
    display: none;
    align-items: center;
    gap: 4px;
    padding: 12px 16px;
    background: white;
    border: 1px solid var(--border-color);
    border-radius: 12px;
    width: fit-content;
    margin-bottom: 1rem;
    margin-left: 48px; 
}
body.rtl .typing-indicator {
    margin-left: 0;
    margin-right: 48px;
}

.dot {
    width: 6px;
    height: 6px;
    background-color: var(--text-light);
    border-radius: 50%;
    animation: bounce 1.4s infinite ease-in-out both;
}
.dot:nth-child(1) { animation-delay: -0.32s; }
.dot:nth-child(2) { animation-delay: -0.16s; }
@keyframes bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* Modal Settings */
.modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    display: none; justify-content: center; align-items: center; z-index: 1000;
    backdrop-filter: blur(2px); opacity: 0; transition: opacity 0.3s ease;
}
.modal-overlay.active { display: flex; opacity: 1; }
.modal-content {
    background-color: white; padding: 2rem; border-radius: 12px;
    width: 90%; max-width: 400px; position: relative;
    transform: translateY(20px); transition: transform 0.3s ease;
}
.modal-overlay.active .modal-content { transform: translateY(0); }
.modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
.modal-header h2 { font-family: 'Lora', serif; font-size: 1.25rem; }
body.rtl .modal-header h2 { font-family: 'Cairo', sans-serif; }
.close-modal { background: none; border: none; font-size: 1.5rem; cursor: pointer; }

.setting-row { display: flex; justify-content: space-between; align-items: center; padding-bottom: 1rem; border-bottom: 1px solid var(--border-color); }
/* Switch */
.switch { position: relative; display: inline-block; width: 50px; height: 26px; }
.switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
.slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
input:checked + .slider { background-color: var(--primary-color); }
input:checked + .slider:before { transform: translateX(24px); }

/* API Key */
.api-section { display: none; flex-direction: column; gap: 8px; margin-top: 1rem; }
#api-key-input { width: 100%; padding: 10px 12px; border: 1px solid var(--border-color); border-radius: 6px; }

@media (max-width: 600px) {
    .intro-title { font-size: 1.8rem; }
    .intro-logo { max-width: 200px; }
}